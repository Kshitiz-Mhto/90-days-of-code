create table sectable (
	id INT,
	first_name VARCHAR(50) not null,
	last_name VARCHAR(50) not null,
	email VARCHAR(50),
	gender VARCHAR(50) not null,
	dob DATE not null,
	income INT not null
);
-- ALTER TABLE table_name DROP CONSTRAINT id;
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (1, 'Josh', 'Steggals', null, 'Male', '10/28/2021', 355376);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (2, 'Hermine', 'Sandy', 'hsandy1@washington.edu', 'Female', '1/1/2022', 152218);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (3, 'Theda', 'Gallgher', null, 'Female', '5/19/2022', 466827);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (4, 'Atlanta', 'Crathern', 'acrathern3@usgs.gov', 'Female', '10/23/2021', 911443);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (5, 'Annelise', 'Deavall', null, 'Female', '12/4/2021', 73889);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (6, 'Decca', 'Widocks', 'dwidocks5@artisteer.com', 'Male', '4/5/2022', 526687);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (7, 'Nan', 'Knill', null, 'Female', '4/20/2022', 102516);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (8, 'Lexine', 'McBoyle', null, 'Female', '6/29/2021', 126555);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (9, 'Tate', 'Kisbey', null, 'Polygender', '5/25/2022', 320588);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (10, 'Humphrey', 'MacAlees', 'hmacalees9@barnesandnoble.com', 'Male', '6/1/2022', 998424);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (11, 'Vasily', 'Kleynermans', null, 'Male', '10/8/2021', 877629);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (12, 'Mortie', 'Ricson', 'mricsonb@cbc.ca', 'Male', '2/20/2022', 788877);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (13, 'Kendall', 'Ascroft', 'kascroftc@google.com.au', 'Genderfluid', '7/15/2021', 860836);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (14, 'Henrik', 'MacKessock', 'hmackessockd@google.pl', 'Male', '12/13/2021', 517685);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (15, 'Kalle', 'Aikman', 'kaikmane@istockphoto.com', 'Non-binary', '12/22/2021', 747699);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (16, 'Emelen', 'Bess', 'ebessf@shinystat.com', 'Male', '12/8/2021', 559416);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (17, 'Shaylynn', 'Graffin', null, 'Female', '6/1/2022', 111093);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (18, 'Codi', 'Skellern', 'cskellernh@about.me', 'Male', '9/12/2021', 845458);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (19, 'Clark', 'Blackeby', 'cblackebyi@stumbleupon.com', 'Male', '1/9/2022', 73951);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (20, 'Napoleon', 'Nerval', 'nnervalj@sciencedaily.com', 'Male', '4/8/2022', 113577);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (21, 'Leonelle', 'Tavinor', 'ltavinork@wix.com', 'Genderfluid', '7/20/2021', 638746);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (22, 'Aldon', 'Cable', null, 'Male', '7/29/2021', 345035);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (23, 'Wayland', 'Adamovicz', null, 'Male', '2/3/2022', 678295);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (24, 'Lucho', 'Mitford', null, 'Male', '11/5/2021', 287694);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (25, 'Lauritz', 'Bandiera', null, 'Male', '8/10/2021', 617358);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (26, 'Nicholle', 'Thurgood', null, 'Female', '5/4/2022', 230173);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (27, 'Ronald', 'De Andreis', null, 'Male', '7/5/2021', 325428);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (28, 'Stan', 'Bachs', 'sbachsr@macromedia.com', 'Male', '6/6/2022', 681839);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (29, 'Gustavo', 'Bartlomiejczyk', 'gbartlomiejczyks@squidoo.com', 'Male', '5/8/2022', 177784);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (30, 'Carissa', 'Corke', null, 'Female', '9/5/2021', 545899);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (31, 'Puff', 'Biagini', 'pbiaginiu@cargocollective.com', 'Male', '4/24/2022', 99133);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (32, 'Marthe', 'Leek', 'mleekv@joomla.org', 'Female', '10/4/2021', 455939);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (33, 'Craggie', 'Sans', null, 'Male', '12/16/2021', 883121);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (34, 'Eldridge', 'Durno', null, 'Male', '8/5/2021', 375891);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (35, 'Hort', 'Archard', 'harchardy@examiner.com', 'Male', '10/26/2021', 70339);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (36, 'Morena', 'Jacobsen', 'mjacobsenz@wikimedia.org', 'Female', '7/30/2021', 23381);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (37, 'Donovan', 'Ebhardt', 'debhardt10@time.com', 'Male', '2/13/2022', 121677);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (38, 'Jemmie', 'Morkham', null, 'Female', '8/4/2021', 423229);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (39, 'Anson', 'Figge', null, 'Genderqueer', '12/29/2021', 827124);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (40, 'Dody', 'Tether', 'dtether13@examiner.com', 'Female', '9/10/2021', 372023);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (41, 'Anthe', 'Greir', 'agreir14@w3.org', 'Female', '12/3/2021', 91185);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (42, 'Frederigo', 'Billingham', 'fbillingham15@gravatar.com', 'Non-binary', '8/27/2021', 788139);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (43, 'Ambrosio', 'Mountfort', null, 'Male', '9/15/2021', 645123);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (44, 'Marthena', 'Blackadder', null, 'Female', '10/19/2021', 287466);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (45, 'Homere', 'Crewes', 'hcrewes18@ebay.com', 'Male', '1/29/2022', 125087);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (46, 'Natka', 'Zini', 'nzini19@nymag.com', 'Female', '3/18/2022', 914916);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (47, 'Kellby', 'Orpwood', 'korpwood1a@ucla.edu', 'Male', '4/21/2022', 637498);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (48, 'Claresta', 'Rampley', 'crampley1b@nydailynews.com', 'Female', '3/13/2022', 606189);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (49, 'Galen', 'Pickles', null, 'Male', '4/22/2022', 647598);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (50, 'Juliann', 'Beer', null, 'Female', '5/22/2022', 253733);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (51, 'Eustacia', 'Blain', 'eblain1e@cbslocal.com', 'Female', '10/16/2021', 783385);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (52, 'Marven', 'Benadette', null, 'Male', '9/13/2021', 105804);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (53, 'Meara', 'Bohlsen', 'mbohlsen1g@yolasite.com', 'Female', '11/6/2021', 89332);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (54, 'Sampson', 'Catto', 'scatto1h@arizona.edu', 'Non-binary', '6/12/2022', 629395);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (55, 'Corly', 'Breheny', null, 'Female', '8/19/2021', 831286);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (56, 'Rosabella', 'Whittlesee', null, 'Female', '7/21/2021', 44738);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (57, 'Kyle', 'Bramley', 'kbramley1k@elpais.com', 'Male', '6/15/2022', 580756);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (58, 'Olivette', 'Guidera', 'oguidera1l@java.com', 'Female', '10/25/2021', 451580);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (59, 'Evy', 'Brussels', 'ebrussels1m@over-blog.com', 'Female', '12/19/2021', 950675);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (60, 'Lona', 'Costellow', null, 'Female', '6/4/2022', 718931);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (61, 'Bo', 'Sarath', null, 'Non-binary', '6/6/2022', 81114);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (62, 'Veronica', 'Hazelgrove', null, 'Female', '5/27/2022', 273216);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (63, 'Catlee', 'Giacomuzzo', 'cgiacomuzzo1q@oracle.com', 'Female', '4/5/2022', 574135);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (64, 'Chrissy', 'Bootherstone', null, 'Female', '6/24/2022', 633404);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (65, 'Darell', 'Yakunikov', null, 'Female', '2/16/2022', 929297);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (66, 'Hayes', 'MacCoughen', 'hmaccoughen1t@ibm.com', 'Male', '12/28/2021', 69001);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (67, 'Hillie', 'Mitchiner', 'hmitchiner1u@unc.edu', 'Male', '8/3/2021', 893317);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (68, 'Rebeka', 'Pallaske', 'rpallaske1v@cnn.com', 'Female', '9/1/2021', 118744);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (69, 'Isidore', 'Laird-Craig', 'ilairdcraig1w@wisc.edu', 'Male', '10/17/2021', 260796);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (70, 'Eleonore', 'Tartt', null, 'Female', '1/24/2022', 896124);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (71, 'Faythe', 'Proudman', null, 'Female', '2/6/2022', 579976);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (72, 'Tammi', 'Siward', 'tsiward1z@hexun.com', 'Female', '8/10/2021', 495815);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (73, 'Honor', 'Fawbert', null, 'Female', '11/23/2021', 920527);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (74, 'Lynde', 'McKaile', 'lmckaile21@odnoklassniki.ru', 'Female', '4/8/2022', 119263);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (75, 'Galvin', 'Haken', 'ghaken22@hatena.ne.jp', 'Male', '11/25/2021', 956974);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (76, 'Hewitt', 'Lingner', null, 'Agender', '2/25/2022', 667641);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (77, 'Artur', 'Kaemena', null, 'Male', '7/27/2021', 457602);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (78, 'Itch', 'Gierhard', null, 'Male', '1/5/2022', 705409);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (79, 'Chicky', 'Newton', 'cnewton26@hibu.com', 'Female', '4/16/2022', 457488);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (80, 'Priscilla', 'Dzenisenka', null, 'Female', '6/16/2022', 885451);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (81, 'Charmian', 'Biskupek', 'cbiskupek28@hubpages.com', 'Female', '4/19/2022', 250343);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (82, 'Rubi', 'Erlam', 'rerlam29@tumblr.com', 'Genderfluid', '3/19/2022', 137825);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (83, 'Clemence', 'Gowry', null, 'Female', '1/9/2022', 715592);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (84, 'Saunder', 'Adame', null, 'Male', '2/2/2022', 540548);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (85, 'Berty', 'Eisold', 'beisold2c@usa.gov', 'Male', '10/17/2021', 303152);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (86, 'Sutherlan', 'Alloway', null, 'Male', '7/6/2021', 69998);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (87, 'Jillian', 'Larder', null, 'Female', '12/28/2021', 650044);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (88, 'Nelia', 'Bettenay', null, 'Female', '11/22/2021', 42513);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (89, 'Dov', 'Luff', null, 'Male', '11/25/2021', 314907);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (90, 'Silva', 'Wilcockes', null, 'Female', '6/1/2022', 620219);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (91, 'Verney', 'Portwaine', null, 'Male', '4/3/2022', 110371);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (92, 'Buckie', 'Radki', 'bradki2j@printfriendly.com', 'Male', '2/14/2022', 481809);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (93, 'Tulley', 'Gebbe', null, 'Male', '3/11/2022', 451055);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (94, 'Eugenius', 'Saffle', null, 'Male', '8/27/2021', 823235);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (95, 'Ashbey', 'Vallery', null, 'Male', '1/18/2022', 702146);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (96, 'Brodie', 'Steffans', 'bsteffans2n@ted.com', 'Male', '1/19/2022', 223328);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (97, 'Goddard', 'Brehault', 'gbrehault2o@surveymonkey.com', 'Male', '9/17/2021', 357558);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (98, 'Hadrian', 'Bouch', 'hbouch2p@amazon.co.uk', 'Male', '1/21/2022', 375920);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (99, 'Prudence', 'Vazquez', null, 'Female', '6/8/2022', 334395);
insert into sectable (id, first_name, last_name, email, gender, dob, income) values (100, 'Drusi', 'Rigbye', 'drigbye2r@businesswire.com', 'Female', '12/12/2021', 121461);

--          Coalesce
-- In PostgreSQL, the COALESCE function returns the first non-null argument. 
-- [[ It is generally used with the SELECT statement to handle null values effectively. ]]
-- Syntax: COALESCE (argument_1, argument_2, …);
-- The COALESCE function accepts an unlimited number of arguments. It returns the first argument that is not null. If all arguments are null, the COALESCE function will return null. he COALESCE function evaluates arguments from left to right until it finds the first non-null argument. All the remaining arguments from the first non-null argument are not evaluated.

---------------------------------------------------------------------------
-- SELECT email from sectable;
-- SELECT COALESCE(email,'email not provided') from sectable;

----------------------------------------------------------------------------
-- select 1/0; -- to handle such exception we have nullif
--The NULLIF function returns a null value if argument_1 equals to argument_2, otherwise it returns argument_1.
--Syntax: NULLIF(argument_1,argument_2);
-- select nullif(10,10);
-- select nullif(8,2);
-- select nullif(0,0);
-- select 10/null; --nothing
-- select 10 / nullif(2,2); -- 10 / null
-- select 10 / nullif(2,1); -- 10 / 2 ---> 5
-- select 10 / nullif(0,0);
-- select COALESCE(10/nullif(0,0),0);

--      Date and Timestamp
--------------------------------------------------------------------------------
-- select now(); -- Timestamp
-- select now()::date;
-- select now()::date + interval '30 hours';
-- select now()::date - interval '1 years';
-- select now()::date - interval '10 days';
-- select (now() + interval '10 months' + interval '2 months')::date;
-- select now()::date+7;
-- select now()::time;
-- select timestamp '2001-09-28 01:00' + interval '23 hours';

--      Extracting Fiels
-------------------------------------------------------------------------------------
-- select now();
-- select Extract(year from now());
-- select Extract(days from now()); -- or day
-- select extract(dow from now()); -- from 0 to 6
-- select extract (century from now());
-- select extract (millisecond from now());
-- select extract (microsecond from now());
-- select extract (picosecond from now());
-- In PostgreSQL the age() function is used to calculate ages.
-- Syntax: age(timestamp, timestamp);
-- Let’s analyze the above syntax:
    -- The age() function accepts two TIMESTAMP values
    -- It subtracts the second argument from the first one and returns an interval as a result
-- select first_name, gender, dob, age(now(), dob) as age from sectable; --actual age

-------------------------------------------------------------------------------------
--      Keys
-- A “key” is a field in a table that is used in the identification of that record. 

-- In relational databases, there are several different types of keys:

--     Primary key
--     Natural key
--     Surrogate key
--     Composite key
--     Alternate key
--     Unique key
--     Foreign key

-------------------------------------------------------------------------------------
-- Primary key
-- A primary key is one or more columns in a table that are used to uniquely identify the row.
-- First, the data in the columns must be unique. If there is a second record that is added with the same values for the primary key as an existing record, the new record won’t be inserted.
-- You’ll get an error saying the primary key says a record already exists.
-- Also, the columns in the primary key cannot contain NULL values. You must specify a value.
-- Finally, a table can have only one primary key. You can’t create a second primary key on a different set of columns after you’ve created your primary key.
-------------------------------------------------------------------------------------
-- Natural Key
-- A natural key is an attribute that exists in the real world or is used by the business. It can be used to uniquely identify the row.
-- Not all types of keys use attributes that are used in the real world, but those that do are called natural keys. Social Security Number (for US citizens)Tax File Number (TFN)

-- There are several advantages of using a natural key as a primary key:
--     It already exists, meaning you don’t need to create a new column in your table.
--     It simplifies the quality of your data as it ensures only one row can exist for this value
-------------------------------------------------------------------------------------
-- Surrogate Key
-- The word surrogate means substitute. A surrogate key is an attribute that is invented or made up for the sole purpose of being used as the primary key.
-- It has no value to the business or the real world.
-- advantages using a surrogate key for your primary key:

--     It has no business or real world value, which means you have control over the format and usage of the value. No matter what happens to the other data in the record (e.g. change in formats or types), this key won’t change.
--     It’s easy to define. There’s no need to work out which of the existing attributes can make a key, as you can use a new column for the identifier.
-- disadvantages of using a surrogate key as your primary key:

--     It’s another extra column in your table, which increases storage space. However, storage is cheap so this may not be an issue.
--     You can’t look at the key and determine anything about the record, unlike a Social Security Number or a Country Name.
-------------------------------------------------------------------------------------
-- Composite KEy
-- A composite key is a primary key, or unique identifier, that is made up or more than one attribute.
-- advantages of using a composite key as a primary key are:

--     The attributes already exist, so you don’t need to create any new attributes or columns on your table like you do with the surrogate key. This simplifies the table and reduces storage.
--     The combination of the attributes ensures the record is unique, like the natural key
--     It allows you to use business values to identify a record if a single value does not uniquely identify a record. If a natural key doesn’t work, you can use a composite key.

-------------------------------------------------------------------------------------
-- Candidate Key
-- A candidate key is any field in the table that could be used as a primary key because it is unique. It can be a natural key, surrogate key, or a composite key.
-- Using our earlier examples, these would be candidate keys for a “customer” table:
--     Social Security Number
--     Customer ID
--     First Name, Last Name, Date of Birth

-------------------------------------------------------------------------------------
-- Alternate Key
-- An alternate key is any of the candidate keys that are not the primary key.Alternate Key
-- They are an option or alternate to the primary key. This can also be called a unique key.
-- For example, using the candidate keys above:
--     Social Security Number
--     Customer ID
--     First Name, Last Name, Date of Birth

-------------------------------------------------------------------------------------
-- Unique Key
-- A unique key is an attribute in the table which is unique. It can be used to identify a row, but may not be the primary key. This can also be called an alternate key.
-- 9606906 – against the white background is bunch of five keys
-- This is because a table can have only one primary key. But there may be more than one unique value in the table.
-- For example, consider a country table that has these fields:

--     Country ID
--     ISO Code
--     Country Name
-------------------------------------------------------------------------------------
-- Foreign Key

-- A foreign key is a column or set of columns in a table that refers to a primary key in another table.Foreign Key
-- They are used to specify that this record in this table is related to that record in that table.

-------------------------------------------------------------------------------------
-- CONSTRAINT, UNIQUE[unique value per column]
\d sectable;
alter table sectable add primary key(id);
\d sectable;
select email, count(*) from sectable group by email;
select email, count(*) from sectable group by email having count(*) > 2;




































